// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// 食事タイプの列挙型
enum MealType {
  LUNCH
  DINNER
}

// 準備担当者の列挙型（既存のPreparationTypeと置き換え）
enum PreparationRole {
  ALICE
  BOB  
  NONE
}

// 参加状況の列挙型（新規追加）
enum ParticipationStatus {
  WILL_PARTICIPATE
  WILL_NOT_PARTICIPATE
  UNDECIDED
}

// 食事予定モデル（統一化）
model MealPlan {
  id                  String              @id @default(uuid())
  date                DateTime            // 日付
  mealType            MealType            @map("meal_type")
  preparationRole     PreparationRole     @map("preparation_role")
  aliceParticipation  ParticipationStatus @map("alice_participation")
  bobParticipation    ParticipationStatus @map("bob_participation")
  currentState        Int                 @map("current_state")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime            @updatedAt @map("updated_at")

  @@unique([date, mealType])
  @@map("meal_plans")
}

model NotificationLog {
  id                String   @id @default(uuid())
  type              String   // MORNING_REMINDER, EVENING_REMINDER, PARTICIPATION_CHANGE, PREPARER_QUIT
  content           String
  targetUser        String   @map("target_user") // Alice, Bob, ALL
  relatedMealPlanId String?  @map("related_meal_plan_id")
  status            String   @default("PENDING") // PENDING, SENT, FAILED
  sentAt            DateTime? @map("sent_at")
  createdAt         DateTime @default(now()) @map("created_at")

  @@map("notification_logs")
}
