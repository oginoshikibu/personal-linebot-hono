# ドメインモデル

## 概要
家庭用食事管理LINEボットのドメインモデルは、食事予定の管理と家族メンバーの参加状況を表現するための中核となる概念を定義します。

## エンティティと関係性

### ユーザー (User)
家族メンバーを表すエンティティです。

**属性:**
- ID: ユーザーの一意識別子
- LINE ID: LINEプラットフォーム上でのユーザー識別子
- 名前: ユーザーの表示名

**振る舞い:**
- 食事予定への参加/不参加を登録する
- 食事の準備方法を設定する
- 食事予定を確認する

**関係:**
- 複数の食事参加情報を持つ
- 食事の調理担当者になることができる

### 食事予定 (MealPlan)
特定の日付と時間帯（昼食/夕食）の食事予定を表すエンティティです。

**属性:**
- ID: 食事予定の一意識別子
- 日付: 予定の日付
- 食事タイプ: 昼食または夕食
- 準備方法: 自炊、各自自由、買って一緒に食べる
- 調理担当者ID: 自炊の場合の調理担当者（オプション）

**振る舞い:**
- 参加者の追加/削除
- 準備方法の変更
- 調理担当者の設定

**関係:**
- 複数の食事参加情報を持つ
- 調理担当者（ユーザー）と関連付けられる場合がある

### 食事参加 (MealParticipation)
ユーザーと食事予定の関係を表す中間エンティティです。

**属性:**
- ID: 食事参加の一意識別子
- 食事予定ID: 関連する食事予定
- ユーザーID: 関連するユーザー
- 参加状態: 参加するかどうかのフラグ

**振る舞い:**
- 参加状態の変更

**関係:**
- 一つの食事予定に属する
- 一人のユーザーに属する

### 通知ログ (NotificationLog)
システムが送信した通知の履歴を表すエンティティです。

**属性:**
- ID: 通知ログの一意識別子
- タイプ: 通知のタイプ（朝の通知、夜の通知、変更通知など）
- 内容: 送信された通知の内容
- 送信日時: 通知が送信された日時

**振る舞い:**
- なし（読み取り専用）

**関係:**
- なし（独立したエンティティ）

## 値オブジェクト

### 食事タイプ (MealType)
食事の時間帯を表す列挙型です。
- 昼食 (LUNCH)
- 夕食 (DINNER)

### 準備方法 (PreparationType)
食事の準備方法を表す列挙型です。
- 自炊 (COOK_BY_SELF): 家族の誰かが調理する
- 各自自由 (INDIVIDUAL): 各自が好きなものを食べる
- 買って一緒に (BUY_TOGETHER): テイクアウトや外食で一緒に食べる

## ドメインサービス

### 食事予定サービス
- 食事予定の作成・更新
- 食事参加状態の設定
- 食事予定の取得

### 通知サービス
- 朝の通知送信
- 夜の通知送信
- 変更通知送信

### LINEメッセージサービス
- テキストメッセージ送信
- テンプレートメッセージ送信
- Flexメッセージ送信

## ビジネスルール

1. 同じ日の同じ食事タイプ（昼食/夕食）の食事予定は一つだけ存在できる
2. 自炊の準備方法が選択された場合は、調理担当者を設定する必要がある
3. 各ユーザーは、一つの食事予定に対して一つの参加状態のみ持つことができる
4. 登録済みのLINE IDを持つユーザーのみがシステムを利用できる
5. 食事予定が変更された場合、他のユーザーに通知する
6. 朝と夜の定期通知は、それぞれ設定された時刻に自動的に送信される 