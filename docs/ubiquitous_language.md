# ユビキタス言語・用語集

## 概要
このドキュメントは、食事管理LINEボットプロジェクトで使用される**ユビキタス言語**（共通言語）を定義します。開発チーム、ドメインエキスパート、ステークホルダー間での一貫したコミュニケーションを確保するため、コード内での使用を含め、これらの用語を統一的に使用します。

---

## 🧑‍🤝‍🧑 ユーザー・アクター

### Alice (アリス)
- **定義**: 家族メンバーの一人。夕食の準備担当者になることができる
- **特徴**: 
  - 夕食において準備担当者として選択可能
  - 昼食では参加者としてのみ機能
  - システム権限はBobと同等
- **コード例**: `PreparationRole.ALICE`, `"Alice"`
- **使用箇所**: コード、UI、ドキュメント全般

### Bob (ボブ)
- **定義**: 家族メンバーの一人。昼食の固定準備担当者
- **特徴**:
  - 昼食において常に準備担当者
  - 夕食では準備担当者または参加者として機能
  - 夕食の初回設定時に担当者を選択する権限を持つ
- **コード例**: `PreparationRole.BOB`, `"Bob"`
- **使用箇所**: コード、UI、ドキュメント全般

---

## 🍽️ 食事関連

### MealPlan (食事計画)
- **定義**: 特定の日付・食事タイプに対する食事の計画
- **構成要素**: 準備担当者、参加状況、現在の状態
- **コード例**: `MealPlan`, `mealPlan`
- **類義語**: 食事予定

### MealType (食事タイプ)
- **LUNCH (昼食)**
  - **制約**: Bob固定担当
  - **状態数**: 4つの状態
  - **特徴**: 担当者変更不可
  
- **DINNER (夕食)**
  - **制約**: Alice/Bob選択可能
  - **状態数**: 5つの状態
  - **特徴**: 初回のみ担当者選択

### PreparationRole (準備担当)
- **定義**: 食事の準備を行う責任者
- **値**:
  - `ALICE`: Aliceが食事を準備
  - `BOB`: Bobが食事を準備
  - `NONE`: 誰も準備しない（各自調達）
- **ビジネスルール**: 担当者は必ず参加状態である

### ParticipationStatus (参加状況)
- **定義**: 食事への参加意向
- **値**:
  - `WILL_PARTICIPATE` (参加): 食事を一緒に食べる
  - `WILL_NOT_PARTICIPATE` (不参加): 食事に参加しない
  - `UNDECIDED` (未定): 参加するかどうか決まっていない（Bobのみ）

---

## 🔄 状態・アクション

### State (状態)
- **定義**: 食事計画の現在の状況を表す番号
- **昼食**: 1-4の状態
- **夕食**: 1-5の状態
- **用途**: 状態遷移の管理、UI表示の制御

### State Transition (状態遷移)
- **定義**: 食事計画の状態が変化すること
- **トリガー**: 参加状況変更、担当者辞退
- **自動遷移**: 担当者辞退時の全員不参加

### Preparer Quits (担当者辞退)
- **定義**: 準備担当者が責任を放棄すること
- **結果**: 全員が自動的に不参加状態になる
- **不可逆**: 一度辞退すると担当者復帰は不可

---

## 🔔 通知関連

### Notification (通知)
- **定義**: ユーザーへの情報伝達メッセージ
- **タイプ**: 定期通知、変更通知

### Morning Reminder (朝の通知)
- **定義**: 当日の食事予定を確認する定期通知
- **送信時刻**: 7:00
- **対象**: 全ユーザー

### Evening Reminder (夜の通知)
- **定義**: 翌日の食事予定を確認する定期通知
- **送信時刻**: 22:00
- **対象**: 全ユーザー

### Change Notification (変更通知)
- **定義**: 食事計画変更時の即時通知
- **対象**: 変更を行っていない他のユーザー
- **条件**: 当日・翌日の変更のみ

---

## 💻 技術用語

### Domain Entity (ドメインエンティティ)
- **定義**: ビジネスロジックを持つドメインオブジェクト
- **例**: MealPlan, User
- **特徴**: 一意のID、ライフサイクル、ビジネスルール

### Value Object (値オブジェクト)
- **定義**: 値によって識別されるイミュータブルなオブジェクト
- **例**: MealType, PreparationRole, ParticipationStatus
- **特徴**: 等価性、不変性

### Repository (リポジトリ)
- **定義**: ドメインオブジェクトの永続化を抽象化
- **例**: MealPlanRepository
- **責務**: CRUD操作、クエリの抽象化

### Business Rule (ビジネスルール)
- **定義**: ドメイン固有の制約や規則
- **例**: 
  - 昼食はBob固定担当
  - 担当者は必ず参加状態
  - 担当者辞退時は全員不参加

---

## 📱 LINEBot関連

### Rich Menu (リッチメニュー)
- **定義**: LINEのタップ可能な固定メニュー
- **構成**: 今日の予定、明日の予定、今週の予定、今後の予定

### Flex Message (Flexメッセージ)
- **定義**: LINEのリッチなレイアウトメッセージ
- **用途**: 食事予定表示、カレンダー表示

### Postback (ポストバック)
- **定義**: ユーザーアクションに対するデータ付き応答
- **形式**: `action=edit_meal&date=2024-01-15&mealType=LUNCH`

---

## 🏗️ アーキテクチャ用語

### Unified Domain (統一ドメイン)
- **定義**: 昼食・夕食を統一的に管理するドメインモデル
- **以前**: 分離されたLunch/Dinnerドメイン
- **現在**: 単一のMealドメイン

### Feature-based Structure (機能ベース構造)
- **定義**: 機能単位でコードを整理する構造
- **例**: `/features/meal/`, `/features/notification/`

### Domain-Driven Design (ドメイン駆動設計)
- **適用**: エンティティ、値オブジェクト、リポジトリパターン
- **目的**: ビジネスロジックの明確化

---

## 📋 定数・設定

### DEFAULT_LUNCH_PREPARER
- **値**: `PreparationRole.BOB`
- **用途**: 昼食の固定担当者設定
- **理由**: ハードコーディング回避

### MEAL_STATES
- **昼食**: 1-4
- **夕食**: 1-5
- **用途**: 状態遷移の管理

---

## 🌍 多言語対応

### Error Messages (エラーメッセージ)
- **方針**: 英語で統一（コード内）
- **理由**: 国際化対応、開発者間の一貫性
- **例外**: UI表示は日本語（将来的にi18n対応）

### Log Messages (ログメッセージ)
- **方針**: 英語で統一
- **理由**: 運用・デバッグ時の効率性

---

## 🔧 開発規約

### Naming Convention (命名規約)
- **ドメイン用語**: そのまま使用（Alice, Bob）
- **ケース**: PascalCase（エンティティ）、camelCase（プロパティ）
- **例**: `MealPlan.changeAliceParticipation()`

### Code Exposure (コード露出)
- **Alice/Bob**: ドメイン用語として適切にコード内で使用
- **理由**: ユビキタス言語の一貫性維持

---

## 📚 関連ドキュメント

- [ドメインモデル](domain/) - 各ドメインの詳細設計
- [要件定義書](requirements.md) - ビジネス要件とユーザーストーリー
- [アーキテクチャ設計書](architecture.md) - システム全体の設計思想

---

**更新履歴**:
- 2025-01-27: 初版作成、統一Mealドメイン対応
- 2025-01-27: Alice/Bob用語の正式化、多言語方針追加

**メンテナンス**: このドキュメントはドメインモデルの変更に合わせて定期的に更新します。